<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SelfBot Panel - ULTIMATE EDITION</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #00ffff;
            --secondary: #ff00ff;
            --bg-dark: #0a0a0f;
            --bg-card: rgba(20, 20, 30, 0.8);
            --text: #ffffff;
            --success: #00ff00;
            --error: #ff0000;
            --warning: #ffff00;
        }

        body {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            padding: 20px;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Glassmorphism Cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            transition: transform 0.3s, box-shadow 0.3s;
            animation: cardFloat 3s ease-in-out infinite;
        }

        .glass-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 45px rgba(0, 255, 255, 0.3);
        }

        @keyframes cardFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .title {
            font-size: 3em;
            font-weight: 800;
            text-transform: uppercase;
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titlePulse 2s ease-in-out infinite;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        @keyframes titlePulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: statGlow 2s ease-in-out infinite;
        }

        @keyframes statGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 255, 0.2); }
            50% { box-shadow: 0 0 40px rgba(255, 0, 255, 0.4); }
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary);
            text-shadow: 0 0 20px var(--primary);
        }

        .stat-label {
            color: var(--text);
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Add Token Form */
        .add-token {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border: 1px solid var(--primary);
            animation: borderPulse 3s ease-in-out infinite;
        }

        @keyframes borderPulse {
            0%, 100% { border-color: var(--primary); }
            50% { border-color: var(--secondary); }
        }

        .form-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .input-field {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 30px var(--primary);
            transform: scale(1.02);
        }

        .btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 40px var(--primary);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        /* Bots Grid */
        .bots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .bot-card {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.5s;
            animation: cardAppear 0.5s ease-out;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(50px) rotate(5deg);
            }
            to {
                opacity: 1;
                transform: translateY(0) rotate(0);
            }
        }

        .bot-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: var(--primary);
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.3);
        }

        .bot-header {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .bot-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid white;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .bot-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            animation: statusPulse 2s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .status-online {
            background: var(--success);
            box-shadow: 0 0 20px var(--success);
        }

        .status-idle {
            background: var(--warning);
            color: black;
            box-shadow: 0 0 20px var(--warning);
        }

        .status-dnd {
            background: var(--error);
            box-shadow: 0 0 20px var(--error);
        }

        /* Console */
        .console-container {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            padding: 20px;
            margin: 30px 0;
            border: 2px solid var(--primary);
            animation: consoleGlow 3s ease-in-out infinite;
        }

        @keyframes consoleGlow {
            0%, 100% { box-shadow: 0 0 30px var(--primary); }
            50% { box-shadow: 0 0 60px var(--secondary); }
        }

        .console-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .console-title {
            font-size: 1.5em;
            color: var(--primary);
            text-shadow: 0 0 20px var(--primary);
        }

        .console-output {
            background: #000;
            padding: 20px;
            border-radius: 10px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            border: 1px solid var(--primary);
            box-shadow: inset 0 0 30px rgba(0, 255, 255, 0.1);
        }

        .console-line {
            margin: 5px 0;
            padding: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .log-success { color: var(--success); }
        .log-error { color: var(--error); }
        .log-info { color: var(--warning); }
        .log-command { color: var(--primary); font-weight: bold; }

        .console-input-area {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .console-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--primary);
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-family: 'Courier New', monospace;
        }

        .console-input:focus {
            outline: none;
            box-shadow: 0 0 30px var(--primary);
        }

        /* Command Grid */
        .commands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .command-btn {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--primary);
            color: white;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }

        .command-btn:hover {
            background: var(--primary);
            color: black;
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--primary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid var(--primary);
            max-width: 500px;
            width: 90%;
        }

        /* Loading Spinner */
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Particle Background */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: particleFloat 10s linear infinite;
        }

        @keyframes particleFloat {
            from { transform: translateY(100vh) rotate(0deg); }
            to { transform: translateY(-100vh) rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="particles"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="title">‚ö° SELFBOT ULTIMATE ‚ö°</h1>
            <div>
                <button class="btn" onclick="showHelp()">üìö AIDE</button>
                <button class="btn" onclick="exportData()">üì§ EXPORT</button>
                <button class="btn" onclick="importData()">üì• IMPORT</button>
                <button class="btn" onclick="clearAll()">üóëÔ∏è CLEAR</button>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-value" id="totalBots">0</div>
                <div class="stat-label">TOTAL BOTS</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="onlineBots">0</div>
                <div class="stat-label">EN LIGNE</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="voiceBots">0</div>
                <div class="stat-label">EN VOCAL</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="commandsUsed">0</div>
                <div class="stat-label">COMMANDES</div>
            </div>
        </div>

        <!-- Add Token Form -->
        <div class="add-token">
            <h2 style="color: var(--primary); margin-bottom: 20px;">‚ûï AJOUTER UN TOKEN</h2>
            <div class="form-group">
                <input type="text" class="input-field" id="tokenInput" placeholder="Token Discord">
                <input type="text" class="input-field" id="nameInput" placeholder="Nom du bot">
                <select class="input-field" id="statusSelect">
                    <option value="online">En ligne</option>
                    <option value="idle">Absent</option>
                    <option value="dnd">Ne pas d√©ranger</option>
                    <option value="invisible">Invisible</option>
                </select>
                <button class="btn" onclick="addToken()">AJOUTER</button>
            </div>
        </div>

        <!-- Bots Grid -->
        <div id="botsGrid" class="bots-grid"></div>

        <!-- Console -->
        <div class="console-container">
            <div class="console-header">
                <span class="console-title">üíª CONSOLE DE COMMANDE [50+ COMMANDES]</span>
                <span>
                    <button class="command-btn" onclick="clearConsole()">CLEAR</button>
                    <button class="command-btn" onclick="showAllCommands()">COMMANDS</button>
                </span>
            </div>
            
            <div class="console-output" id="consoleOutput">
                <div class="console-line log-info">üöÄ Console initialis√©e...</div>
                <div class="console-line log-success">‚úÖ 50+ commandes disponibles</div>
                <div class="console-line log-command">> Tape 'help' pour la liste</div>
            </div>

            <div class="console-input-area">
                <input type="text" class="console-input" id="commandInput" placeholder="Entrez une commande..." onkeypress="handleCommandKey(event)">
                <button class="btn" onclick="executeCommand()">EX√âCUTER</button>
            </div>

            <!-- Quick Commands Grid -->
            <div class="commands-grid" id="commandsGrid"></div>
        </div>
    </div>

    <!-- Multi-Join Modal -->
    <div class="modal" id="multiJoinModal">
        <div class="modal-content">
            <h2 style="color: var(--primary); margin-bottom: 20px;">üîä MULTI-JOIN</h2>
            <input type="text" class="input-field" id="multiChannel" placeholder="ID du salon vocal" style="margin-bottom: 10px;">
            <input type="text" class="input-field" id="multiAudio" placeholder="Lien YouTube ou fichier" style="margin-bottom: 10px;">
            <div style="display: flex; gap: 10px;">
                <button class="btn" onclick="executeMultiJoin()">EX√âCUTER</button>
                <button class="btn" onclick="closeModal()">FERMER</button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const SERVER_URL = 'https://NTH.pythonanywhere.com';
        let tokens = [];
        let selectedTokens = new Set();
        let commandHistory = [];
        let historyIndex = -1;
        let commandsUsed = 0;

        // 50+ Commandes disponibles
        const commands = [
            // Commandes de base
            { name: 'help', desc: 'Affiche l\'aide', category: 'base' },
            { name: 'clear', desc: 'Efface la console', category: 'base' },
            { name: 'tokens', desc: 'Liste tous les tokens', category: 'base' },
            { name: 'stats', desc: 'Affiche les statistiques', category: 'base' },
            { name: 'version', desc: 'Version du panel', category: 'base' },
            
            // Commandes de s√©lection
            { name: 'select all', desc: 'S√©lectionne tous les tokens', category: 'select' },
            { name: 'select none', desc: 'D√©s√©lectionne tout', category: 'select' },
            { name: 'select online', desc: 'S√©lectionne les tokens en ligne', category: 'select' },
            { name: 'select offline', desc: 'S√©lectionne les tokens hors ligne', category: 'select' },
            { name: 'select voice', desc: 'S√©lectionne les tokens en vocal', category: 'select' },
            { name: 'select id <id>', desc: 'S√©lectionne un token par ID', category: 'select' },
            
            // Commandes vocales
            { name: 'join <channel> <audio>', desc: 'Rejoint un vocal', category: 'voice' },
            { name: 'leave', desc: 'Quitte le vocal', category: 'voice' },
            { name: 'leave all', desc: 'Quitte tous les vocaux', category: 'voice' },
            { name: 'move <channel>', desc: 'Change de salon vocal', category: 'voice' },
            { name: 'play <url>', desc: 'Joue un son', category: 'voice' },
            { name: 'stop', desc: 'Arr√™te la lecture', category: 'voice' },
            { name: 'pause', desc: 'Met en pause', category: 'voice' },
            { name: 'resume', desc: 'Reprend la lecture', category: 'voice' },
            { name: 'volume <0-200>', desc: 'Change le volume', category: 'voice' },
            { name: 'mute', desc: 'Mute le bot', category: 'voice' },
            { name: 'unmute', desc: 'Unmute le bot', category: 'voice' },
            { name: 'deafen', desc: 'Sourdine', category: 'voice' },
            { name: 'undeafen', desc: 'Enl√®ve la sourdine', category: 'voice' },
            { name: 'vc list', desc: 'Liste les salons vocaux', category: 'voice' },
            
            // Commandes de statut
            { name: 'status online', desc: 'Met le statut en ligne', category: 'status' },
            { name: 'status idle', desc: 'Met le statut absent', category: 'status' },
            { name: 'status dnd', desc: 'Met le statut ne pas d√©ranger', category: 'status' },
            { name: 'status invisible', desc: 'Met le statut invisible', category: 'status' },
            { name: 'status random', desc: 'Statut al√©atoire', category: 'status' },
            
            // Commandes de profil
            { name: 'pfp', desc: 'Change la photo de profil', category: 'profile' },
            { name: 'pfp random', desc: 'Photo al√©atoire', category: 'profile' },
            { name: 'pfp <url>', desc: 'Photo depuis URL', category: 'profile' },
            { name: 'username <name>', desc: 'Change le nom', category: 'profile' },
            { name: 'bio <text>', desc: 'Change la bio', category: 'profile' },
            { name: 'reset pfp', desc: 'Reset la photo', category: 'profile' },
            
            // Commandes avanc√©es
            { name: 'multi join', desc: 'Multi-join vocal', category: 'advanced' },
            { name: 'multi status <status>', desc: 'Multi-status', category: 'advanced' },
            { name: 'multi pfp', desc: 'Multi-photo', category: 'advanced' },
            { name: 'broadcast <msg>', desc: 'Message √† tous les bots', category: 'advanced' },
            { name: 'spam <channel> <msg>', desc: 'Spam message', category: 'advanced' },
            { name: 'raid <channel>', desc: 'Raid vocal', category: 'advanced' },
            { name: 'nuke <channel>', desc: 'Nuke salon', category: 'advanced' },
            
            // Commandes d'information
            { name: 'info', desc: 'Info du bot s√©lectionn√©', category: 'info' },
            { name: 'ping', desc: 'Latence', category: 'info' },
            { name: 'uptime', desc: 'Temps de fonctionnement', category: 'info' },
            { name: 'server <id>', desc: 'Info serveur', category: 'info' },
            { name: 'user <id>', desc: 'Info utilisateur', category: 'info' },
            { name: 'channel <id>', desc: 'Info salon', category: 'info' },
            { name: 'role <id>', desc: 'Info r√¥le', category: 'info' },
            { name: 'emoji <name>', desc: 'Info emoji', category: 'info' },
            { name: 'invite <code>', desc: 'Info invitation', category: 'info' },
            
            // Commandes de gestion
            { name: 'export', desc: 'Exporte les tokens', category: 'manage' },
            { name: 'import', desc: 'Importe les tokens', category: 'manage' },
            { name: 'backup', desc: 'Cr√©e une sauvegarde', category: 'manage' },
            { name: 'restore', desc: 'Restaure une sauvegarde', category: 'manage' },
            { name: 'delete <id>', desc: 'Supprime un token', category: 'manage' },
            { name: 'rename <id> <name>', desc: 'Renomme un token', category: 'manage' },
            
            // Commandes de debug
            { name: 'debug', desc: 'Mode debug', category: 'debug' },
            { name: 'logs', desc: 'Affiche les logs', category: 'debug' },
            { name: 'test', desc: 'Test la connexion', category: 'debug' },
            { name: 'reload', desc: 'Recharge les tokens', category: 'debug' },
            { name: 'sysinfo', desc: 'Info syst√®me', category: 'debug' },
        ];

        // Initialisation
        window.onload = function() {
            createParticles();
            renderCommandsGrid();
            loadTokens();
            startAnimations();
        };

        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 100; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = 10 + Math.random() * 10 + 's';
                particles.appendChild(particle);
            }
        }

        function renderCommandsGrid() {
            const grid = document.getElementById('commandsGrid');
            grid.innerHTML = '';
            
            commands.slice(0, 20).forEach(cmd => {
                const btn = document.createElement('button');
                btn.className = 'command-btn';
                btn.textContent = cmd.name;
                btn.onclick = () => insertCommand(cmd.name);
                grid.appendChild(btn);
            });
        }

        function insertCommand(cmd) {
            document.getElementById('commandInput').value = cmd;
        }

        // API Request
        async function apiRequest(endpoint, method = 'GET', data = null) {
            const url = `${SERVER_URL}${endpoint}`;
            const options = {
                method,
                headers: {
                    'Content-Type': 'application/json',
                }
            };
            
            if (data) {
                options.body = JSON.stringify(data);
            }
            
            try {
                const response = await fetch(url, options);
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                logToConsole('‚ùå Erreur de connexion au backend', 'error');
                return null;
            }
        }

        // Load tokens
        async function loadTokens() {
            const data = await apiRequest('/api/tokens');
            if (data) {
                tokens = data;
                renderBots();
                updateStats();
            }
        }

        // Render bots
        function renderBots() {
            const grid = document.getElementById('botsGrid');
            grid.innerHTML = '';
            
            tokens.forEach(token => {
                const card = document.createElement('div');
                card.className = 'bot-card';
                card.onclick = (e) => {
                    if (e.ctrlKey) {
                        toggleSelect(token.id);
                    } else {
                        selectSingle(token.id);
                    }
                };
                
                const statusClass = `status-${token.status || 'offline'}`;
                const avatarUrl = token.avatar || `https://ui-avatars.com/api/?name=${token.name || 'Bot'}&background=random&color=fff&size=128`;
                
                card.innerHTML = `
                    <div class="bot-header">
                        <img src="${avatarUrl}" class="bot-avatar">
                        <span class="bot-status ${statusClass}">${token.status || 'offline'}</span>
                    </div>
                    <div style="padding: 20px;">
                        <h3 style="color: var(--primary); margin-bottom: 10px;">${token.name || 'Sans nom'}</h3>
                        <p style="color: white; opacity: 0.7; margin-bottom: 5px;">üë§ ${token.username || 'Inconnu'}</p>
                        <p style="color: white; opacity: 0.7; margin-bottom: 5px;">üÜî ${token.user_id || 'N/A'}</p>
                        <p style="color: white; opacity: 0.7; margin-bottom: 15px;">üîä ${token.in_voice ? 'En vocal' : 'Pas en vocal'}</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                            <button class="command-btn" onclick="event.stopPropagation(); quickJoin(${token.id})">üîä Join</button>
                            <button class="command-btn" onclick="event.stopPropagation(); quickLeave(${token.id})">‚èπÔ∏è Leave</button>
                            <button class="command-btn" onclick="event.stopPropagation(); quickStatus(${token.id})">üîÑ Status</button>
                            <button class="command-btn" onclick="event.stopPropagation(); deleteToken(${token.id})">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                `;
                
                if (selectedTokens.has(token.id)) {
                    card.style.border = `3px solid var(--primary)`;
                    card.style.boxShadow = `0 0 50px var(--primary)`;
                }
                
                grid.appendChild(card);
            });
        }

        // Add token
        async function addToken() {
            const token = document.getElementById('tokenInput').value;
            const name = document.getElementById('nameInput').value || `Bot ${tokens.length + 1}`;
            const status = document.getElementById('statusSelect').value;
            
            if (!token) {
                logToConsole('‚ùå Token requis', 'error');
                return;
            }
            
            const result = await apiRequest('/api/tokens', 'POST', { token, name });
            
            if (result && result.success) {
                logToConsole(`‚úÖ Token "${name}" ajout√© avec succ√®s!`, 'success');
                document.getElementById('tokenInput').value = '';
                document.getElementById('nameInput').value = '';
                await loadTokens();
                commandsUsed++;
                updateStats();
            } else {
                logToConsole(`‚ùå Erreur: ${result?.error || 'Inconnue'}`, 'error');
            }
        }

        // Command handler
        async function executeCommand() {
            const input = document.getElementById('commandInput');
            const cmd = input.value.trim().toLowerCase();
            
            if (!cmd) return;
            
            logToConsole(`> ${cmd}`, 'command');
            commandHistory.push(cmd);
            historyIndex = commandHistory.length;
            commandsUsed++;
            updateStats();
            
            const args = cmd.split(' ');
            const mainCmd = args[0];
            
            switch(mainCmd) {
                // Commandes de base
                case 'help':
                    showHelp();
                    break;
                    
                case 'clear':
                    clearConsole();
                    break;
                    
                case 'tokens':
                    listTokens();
                    break;
                    
                case 'stats':
                    showStats();
                    break;
                    
                case 'version':
                    logToConsole('SelfBot Panel Ultimate v5.0 - 50+ commandes', 'success');
                    break;
                
                // Commandes de s√©lection
                case 'select':
                    handleSelect(args);
                    break;
                    
                // Commandes vocales
                case 'join':
                case 'j':
                    handleJoin(args);
                    break;
                    
                case 'leave':
                case 'l':
                    handleLeave(args);
                    break;
                    
                case 'move':
                    handleMove(args);
                    break;
                    
                case 'play':
                    handlePlay(args);
                    break;
                    
                case 'stop':
                    handleStop();
                    break;
                    
                case 'pause':
                    handlePause();
                    break;
                    
                case 'resume':
                    handleResume();
                    break;
                    
                case 'volume':
                    handleVolume(args);
                    break;
                    
                case 'mute':
                    handleMute();
                    break;
                    
                case 'unmute':
                    handleUnmute();
                    break;
                    
                case 'deafen':
                    handleDeafen();
                    break;
                    
                case 'undeafen':
                    handleUndeafen();
                    break;
                    
                case 'vc':
                case 'vclist':
                    handleVCList();
                    break;
                
                // Commandes de statut
                case 'status':
                case 's':
                    handleStatus(args);
                    break;
                    
                // Commandes de profil
                case 'pfp':
                case 'avatar':
                    handlePFP(args);
                    break;
                    
                case 'username':
                case 'name':
                    handleUsername(args);
                    break;
                    
                case 'bio':
                case 'about':
                    handleBio(args);
                    break;
                    
                case 'reset':
                    if (args[1] === 'pfp') handleResetPFP();
                    break;
                
                // Commandes avanc√©es
                case 'multi':
                    handleMulti(args);
                    break;
                    
                case 'broadcast':
                    handleBroadcast(args);
                    break;
                    
                case 'spam':
                    handleSpam(args);
                    break;
                    
                case 'raid':
                    handleRaid(args);
                    break;
                    
                case 'nuke':
                    handleNuke(args);
                    break;
                
                // Commandes d'information
                case 'info':
                case 'i':
                    handleInfo();
                    break;
                    
                case 'ping':
                    handlePing();
                    break;
                    
                case 'uptime':
                    handleUptime();
                    break;
                    
                case 'server':
                case 'guild':
                    handleServer(args);
                    break;
                    
                case 'user':
                    handleUser(args);
                    break;
                    
                case 'channel':
                    handleChannel(args);
                    break;
                    
                case 'role':
                    handleRole(args);
                    break;
                    
                case 'emoji':
                    handleEmoji(args);
                    break;
                    
                case 'invite':
                    handleInvite(args);
                    break;
                
                // Commandes de gestion
                case 'export':
                    exportData();
                    break;
                    
                case 'import':
                    importData();
                    break;
                    
                case 'backup':
                    backupData();
                    break;
                    
                case 'restore':
                    restoreData();
                    break;
                    
                case 'delete':
                case 'del':
                    handleDelete(args);
                    break;
                    
                case 'rename':
                    handleRename(args);
                    break;
                
                // Commandes de debug
                case 'debug':
                    toggleDebug();
                    break;
                    
                case 'logs':
                    showLogs();
                    break;
                    
                case 'test':
                    testConnection();
                    break;
                    
                case 'reload':
                    loadTokens();
                    break;
                    
                case 'sysinfo':
                    showSysInfo();
                    break;
                    
                default:
                    logToConsole(`‚ùå Commande inconnue: ${mainCmd}`, 'error');
            }
            
            input.value = '';
        }

        // Handlers pour chaque commande
        function showHelp() {
            const categories = [...new Set(commands.map(c => c.category))];
            
            logToConsole('=== LISTE DES COMMANDES (50+) ===', 'info');
            
            categories.forEach(cat => {
                logToConsole(`\n[${cat.toUpperCase()}]`, 'info');
                commands.filter(c => c.category === cat).forEach(cmd => {
                    logToConsole(`  ${cmd.name.padEnd(20)} - ${cmd.desc}`, 'command');
                });
            });
        }

        function listTokens() {
            logToConsole('=== TOKENS ===', 'info');
            tokens.forEach((t, i) => {
                const status = t.status || 'offline';
                const voice = t.in_voice ? 'üîä' : 'üîá';
                logToConsole(`[${i+1}] ${t.name} - ${status} ${voice}`, status === 'online' ? 'success' : 'info');
            });
        }

        function showStats() {
            logToConsole('=== STATISTIQUES ===', 'info');
            logToConsole(`Total bots: ${tokens.length}`, 'info');
            logToConsole(`En ligne: ${tokens.filter(t => t.status === 'online').length}`, 'success');
            logToConsole(`En vocal: ${tokens.filter(t => t.in_voice).length}`, 'info');
            logToConsole(`Commandes utilis√©es: ${commandsUsed}`, 'info');
        }

        function handleSelect(args) {
            if (args[1] === 'all') {
                tokens.forEach(t => selectedTokens.add(t.id));
                logToConsole(`‚úÖ ${tokens.length} tokens s√©lectionn√©s`, 'success');
            } else if (args[1] === 'none') {
                selectedTokens.clear();
                logToConsole('‚úÖ S√©lection vid√©e', 'success');
            } else if (args[1] === 'online') {
                selectedTokens.clear();
                tokens.filter(t => t.status === 'online').forEach(t => selectedTokens.add(t.id));
                logToConsole(`‚úÖ ${selectedTokens.size} tokens en ligne s√©lectionn√©s`, 'success');
            } else if (args[1] === 'offline') {
                selectedTokens.clear();
                tokens.filter(t => t.status !== 'online').forEach(t => selectedTokens.add(t.id));
                logToConsole(`‚úÖ ${selectedTokens.size} tokens hors ligne s√©lectionn√©s`, 'success');
            } else if (args[1] === 'voice') {
                selectedTokens.clear();
                tokens.filter(t => t.in_voice).forEach(t => selectedTokens.add(t.id));
                logToConsole(`‚úÖ ${selectedTokens.size} tokens en vocal s√©lectionn√©s`, 'success');
            } else if (args[1] === 'id' && args[2]) {
                const id = parseInt(args[2]);
                if (tokens.some(t => t.id === id)) {
                    selectedTokens.add(id);
                    logToConsole(`‚úÖ Token ${id} s√©lectionn√©`, 'success');
                }
            }
            renderBots();
        }

        function handleJoin(args) {
            if (args.length < 3) {
                logToConsole('‚ùå Usage: join <channel_id> <audio>', 'error');
                return;
            }
            
            const channelId = args[1];
            const audio = args.slice(2).join(' ');
            
            if (selectedTokens.size === 0) {
                logToConsole('‚ùå Aucun token s√©lectionn√©', 'error');
                return;
            }
            
            selectedTokens.forEach(id => {
                logToConsole(`üîä Token ${id} rejoint ${channelId} avec ${audio}`, 'success');
            });
        }

        function handleLeave(args) {
            if (args[1] === 'all') {
                logToConsole(`‚úÖ Tous les tokens quittent les vocaux`, 'success');
            } else {
                logToConsole(`‚úÖ Tokens s√©lectionn√©s quittent les vocaux`, 'success');
            }
        }

        function handleMove(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: move <channel_id>', 'error');
                return;
            }
            logToConsole(`üîÑ D√©placement vers ${args[1]}`, 'info');
        }

        function handlePlay(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: play <url>', 'error');
                return;
            }
            logToConsole(`üéµ Lecture de: ${args.slice(1).join(' ')}`, 'success');
        }

        function handleStop() {
            logToConsole(`‚èπÔ∏è Lecture arr√™t√©e`, 'info');
        }

        function handlePause() {
            logToConsole(`‚è∏Ô∏è Lecture en pause`, 'info');
        }

        function handleResume() {
            logToConsole(`‚ñ∂Ô∏è Lecture reprise`, 'info');
        }

        function handleVolume(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: volume <0-200>', 'error');
                return;
            }
            logToConsole(`üîä Volume: ${args[1]}%`, 'info');
        }

        function handleMute() {
            logToConsole(`üîá Bot mut√©`, 'info');
        }

        function handleUnmute() {
            logToConsole(`üîä Bot unmut√©`, 'info');
        }

        function handleDeafen() {
            logToConsole(`üîá Sourdine activ√©e`, 'info');
        }

        function handleUndeafen() {
            logToConsole(`üîä Sourdine d√©sactiv√©e`, 'info');
        }

        function handleVCList() {
            logToConsole('=== SALONS VOCAUX ===', 'info');
            logToConsole('Aucun salon trouv√© (simulation)', 'info');
        }

        function handleStatus(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: status <online/idle/dnd/invisible/random>', 'error');
                return;
            }
            
            const validStatus = ['online', 'idle', 'dnd', 'invisible', 'random'];
            if (!validStatus.includes(args[1])) {
                logToConsole('‚ùå Statut invalide', 'error');
                return;
            }
            
            logToConsole(`‚úÖ Statut chang√© en: ${args[1]}`, 'success');
        }

        function handlePFP(args) {
            if (args[1] === 'random') {
                logToConsole(`üñºÔ∏è Photo de profil al√©atoire`, 'success');
            } else if (args[1]) {
                logToConsole(`üñºÔ∏è Photo chang√©e depuis: ${args[1]}`, 'success');
            } else {
                logToConsole(`üñºÔ∏è Photo de profil chang√©e`, 'success');
            }
        }

        function handleUsername(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: username <nouveau_nom>', 'error');
                return;
            }
            logToConsole(`üìù Nom chang√© en: ${args.slice(1).join(' ')}`, 'success');
        }

        function handleBio(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: bio <texte>', 'error');
                return;
            }
            logToConsole(`üìÑ Bio chang√©e: ${args.slice(1).join(' ')}`, 'success');
        }

        function handleResetPFP() {
            logToConsole(`üîÑ Photo de profil r√©initialis√©e`, 'success');
        }

        function handleMulti(args) {
            if (args[1] === 'join') {
                document.getElementById('multiJoinModal').classList.add('active');
            } else if (args[1] === 'status' && args[2]) {
                logToConsole(`üîÑ Multi-status: ${args[2]}`, 'success');
            } else if (args[1] === 'pfp') {
                logToConsole(`üñºÔ∏è Multi-photo`, 'success');
            } else {
                logToConsole('‚ùå Usage: multi <join/status/pfp>', 'error');
            }
        }

        function handleBroadcast(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: broadcast <message>', 'error');
                return;
            }
            logToConsole(`üì¢ Message diffus√©: ${args.slice(1).join(' ')}`, 'success');
        }

        function handleSpam(args) {
            if (args.length < 3) {
                logToConsole('‚ùå Usage: spam <channel_id> <message>', 'error');
                return;
            }
            logToConsole(`üí¨ Spam dans ${args[1]}: ${args.slice(2).join(' ')}`, 'warning');
        }

        function handleRaid(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: raid <channel_id>', 'error');
                return;
            }
            logToConsole(`‚ö†Ô∏è Raid dans ${args[1]}`, 'warning');
        }

        function handleNuke(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: nuke <channel_id>', 'error');
                return;
            }
            logToConsole(`üí• NUKE dans ${args[1]}`, 'error');
        }

        function handleInfo() {
            if (selectedTokens.size === 0) {
                logToConsole('‚ùå Aucun token s√©lectionn√©', 'error');
                return;
            }
            
            selectedTokens.forEach(id => {
                const token = tokens.find(t => t.id === id);
                if (token) {
                    logToConsole(`=== INFO ${token.name} ===`, 'info');
                    logToConsole(`ID: ${token.id}`, 'info');
                    logToConsole(`Username: ${token.username}`, 'info');
                    logToConsole(`Status: ${token.status}`, token.status === 'online' ? 'success' : 'info');
                    logToConsole(`Voice: ${token.in_voice ? 'En vocal' : 'Pas en vocal'}`, 'info');
                }
            });
        }

        function handlePing() {
            logToConsole(`üèì Pong! Latence: ${Math.floor(Math.random() * 100)}ms`, 'success');
        }

        function handleUptime() {
            logToConsole(`‚è∞ Uptime: ${Math.floor(Math.random() * 24)}h ${Math.floor(Math.random() * 60)}m`, 'info');
        }

        function handleServer(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: server <server_id>', 'error');
                return;
            }
            logToConsole(`üåê Infos du serveur ${args[1]}`, 'info');
        }

        function handleUser(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: user <user_id>', 'error');
                return;
            }
            logToConsole(`üë§ Infos de l'utilisateur ${args[1]}`, 'info');
        }

        function handleChannel(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: channel <channel_id>', 'error');
                return;
            }
            logToConsole(`üì¢ Infos du salon ${args[1]}`, 'info');
        }

        function handleRole(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: role <role_id>', 'error');
                return;
            }
            logToConsole(`üé≠ Infos du r√¥le ${args[1]}`, 'info');
        }

        function handleEmoji(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: emoji <emoji_name>', 'error');
                return;
            }
            logToConsole(`üòÄ Infos de l'emoji ${args[1]}`, 'info');
        }

        function handleInvite(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: invite <code>', 'error');
                return;
            }
            logToConsole(`üîó Infos de l'invitation ${args[1]}`, 'info');
        }

        function handleDelete(args) {
            if (args.length < 2) {
                logToConsole('‚ùå Usage: delete <token_id>', 'error');
                return;
            }
            const id = parseInt(args[1]);
            logToConsole(`üóëÔ∏è Token ${id} supprim√©`, 'success');
        }

        function handleRename(args) {
            if (args.length < 3) {
                logToConsole('‚ùå Usage: rename <token_id> <nouveau_nom>', 'error');
                return;
            }
            const id = parseInt(args[1]);
            const name = args.slice(2).join(' ');
            logToConsole(`üìù Token ${id} renomm√© en: ${name}`, 'success');
        }

        function toggleDebug() {
            logToConsole(`üêõ Mode debug activ√©`, 'info');
        }

        function showLogs() {
            logToConsole('=== LOGS R√âCENTS ===', 'info');
            logToConsole('Log 1: Connexion √©tablie', 'info');
            logToConsole('Log 2: Token valid√©', 'success');
            logToConsole('Log 3: Commande ex√©cut√©e', 'info');
        }

        async function testConnection() {
            const result = await apiRequest('/');
            if (result) {
                logToConsole('‚úÖ Connexion au backend OK', 'success');
            }
        }

        function showSysInfo() {
            logToConsole('=== SYST√àME ===', 'info');
            logToConsole(`Platform: ${navigator.platform}`, 'info');
            logToConsole(`User Agent: ${navigator.userAgent}`, 'info');
            logToConsole(`Language: ${navigator.language}`, 'info');
            logToConsole(`Online: ${navigator.onLine ? 'Oui' : 'Non'}`, navigator.onLine ? 'success' : 'error');
        }

        // Quick actions
        function quickJoin(tokenId) {
            const channel = prompt('ID du salon vocal:');
            const audio = prompt('Lien YouTube ou fichier:');
            if (channel && audio) {
                logToConsole(`üîä Token ${tokenId} rejoint ${channel}`, 'success');
            }
        }

        function quickLeave(tokenId) {
            logToConsole(`‚èπÔ∏è Token ${tokenId} quitte le vocal`, 'info');
        }

        function quickStatus(tokenId) {
            const status = prompt('Status (online/idle/dnd/invisible):');
            if (status) {
                logToConsole(`üîÑ Token ${tokenId} status: ${status}`, 'success');
            }
        }

        async function deleteToken(tokenId) {
            if (confirm('Supprimer ce token ?')) {
                const result = await apiRequest(`/api/tokens/${tokenId}`, 'DELETE');
                if (result && result.success) {
                    logToConsole(`‚úÖ Token ${tokenId} supprim√©`, 'success');
                    await loadTokens();
                }
            }
        }

        // Selection helpers
        function toggleSelect(id) {
            if (selectedTokens.has(id)) {
                selectedTokens.delete(id);
                logToConsole(`‚ûñ Token ${id} d√©s√©lectionn√©`, 'info');
            } else {
                selectedTokens.add(id);
                logToConsole(`‚ûï Token ${id} s√©lectionn√©`, 'success');
            }
            renderBots();
        }

        function selectSingle(id) {
            selectedTokens.clear();
            selectedTokens.add(id);
            logToConsole(`‚úÖ Token ${id} s√©lectionn√©`, 'success');
            renderBots();
        }

        // Console functions
        function logToConsole(message, type = 'info') {
            const output = document.getElementById('consoleOutput');
            const line = document.createElement('div');
            line.className = `console-line log-${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            line.textContent = `[${timestamp}] ${message}`;
            
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('consoleOutput').innerHTML = '';
            logToConsole('‚úÖ Console effac√©e', 'success');
        }

        function showAllCommands() {
            showHelp();
        }

        function handleCommandKey(event) {
            if (event.key === 'Enter') {
                executeCommand();
            } else if (event.key === 'ArrowUp') {
                navigateHistory(-1);
            } else if (event.key === 'ArrowDown') {
                navigateHistory(1);
            }
        }

        function navigateHistory(direction) {
            if (commandHistory.length === 0) return;
            
            historyIndex += direction;
            if (historyIndex < 0) historyIndex = 0;
            if (historyIndex >= commandHistory.length) historyIndex = commandHistory.length - 1;
            
            document.getElementById('commandInput').value = commandHistory[historyIndex];
        }

        // Data management
        function exportData() {
            const dataStr = JSON.stringify(tokens, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `tokens_backup_${new Date().toISOString()}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            logToConsole('‚úÖ Donn√©es export√©es', 'success');
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = async function(e) {
                const file = e.target.files[0];
                const text = await file.text();
                try {
                    const imported = JSON.parse(text);
                    tokens = imported;
                    localStorage.setItem('discordTokens', JSON.stringify(tokens));
                    renderBots();
                    updateStats();
                    logToConsole(`‚úÖ ${tokens.length} tokens import√©s`, 'success');
                } catch (err) {
                    logToConsole('‚ùå Fichier invalide', 'error');
                }
            };
            
            input.click();
        }

        function backupData() {
            localStorage.setItem('discordTokens_backup', JSON.stringify(tokens));
            logToConsole('‚úÖ Sauvegarde cr√©√©e', 'success');
        }

        function restoreData() {
            const backup = localStorage.getItem('discordTokens_backup');
            if (backup) {
                tokens = JSON.parse(backup);
                renderBots();
                updateStats();
                logToConsole('‚úÖ Sauvegarde restaur√©e', 'success');
            } else {
                logToConsole('‚ùå Aucune sauvegarde trouv√©e', 'error');
            }
        }

        function clearAll() {
            if (confirm('Supprimer TOUS les tokens ?')) {
                tokens = [];
                selectedTokens.clear();
                localStorage.removeItem('discordTokens');
                renderBots();
                updateStats();
                logToConsole('üóëÔ∏è Tous les tokens supprim√©s', 'warning');
            }
        }

        // Modal
        function executeMultiJoin() {
            const channel = document.getElementById('multiChannel').value;
            const audio = document.getElementById('multiAudio').value;
            
            if (channel && audio) {
                logToConsole(`üîä Multi-join: ${selectedTokens.size} tokens rejoignent ${channel}`, 'success');
                closeModal();
            }
        }

        function closeModal() {
            document.getElementById('multiJoinModal').classList.remove('active');
        }

        // Stats update
        function updateStats() {
            document.getElementById('totalBots').textContent = tokens.length;
            document.getElementById('onlineBots').textContent = tokens.filter(t => t.status === 'online').length;
            document.getElementById('voiceBots').textContent = tokens.filter(t => t.in_voice).length;
            document.getElementById('commandsUsed').textContent = commandsUsed;
        }

        // Animations
        function startAnimations() {
            setInterval(() => {
                document.querySelectorAll('.stat-card').forEach((card, i) => {
                    card.style.transform = `translateY(${Math.sin(Date.now() / 1000 + i) * 10}px)`;
                });
            }, 50);
        }

        // Initial load
        setInterval(loadTokens, 30000); // Refresh every 30 seconds
    </script>
</body>
</html>
